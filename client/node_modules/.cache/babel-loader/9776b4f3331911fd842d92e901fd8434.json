{"ast":null,"code":"import _slicedToArray from\"/Users/pc/KolomoyetsProjects/Study/project-zigzag/project-zigzag/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{Link,useNavigate}from'react-router-dom';import AuthService from'../../api/services/auth';import AppContext from'../../store/context/app';import Button from'../../components/button';import Input from'../../components/input';import Logo from'../../components/logo';import'./login.scss';import SummaryContext from'../../store/context/summary';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),login=_useState2[0],setLogin=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),loginError=_useState6[0],setLoginError=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),passwordError=_useState8[0],setPasswordError=_useState8[1];var _AppContext$useContex=AppContext.useContext(),isLoading=_AppContext$useContex.data.isLoading,setAppData=_AppContext$useContex.setData;var _SummaryContext$useCo=SummaryContext.useContext(),setSummaryData=_SummaryContext$useCo.setData;var navigate=useNavigate();var onLoginChange=function onLoginChange(event){setLogin(event.target.value);setLoginError('');};var onPasswordChange=function onPasswordChange(event){setPassword(event.target.value);setPasswordError('');};var onSubmit=function onSubmit(event){if(event)event.preventDefault();if(!login)return setLoginError('Enter email or nickname');if(!password)return setPasswordError('Enter password');setAppData({isLoading:true});AuthService.login({email:login,password:password}).then(function(res){var _res$data=res.data,token=_res$data.token,user=_res$data.user;setAppData({user:user,token:token});localStorage.setItem('userId',user._id);localStorage.setItem('AuthToken',token);}).then(function(){return navigate('/main');}).catch(function(err){console.log(err.response.message);setPassword('');setLogin('');setSummaryData({isShow:true,isSuccess:false,title:\"Something went wrong!\",subtitle:err.response.data.message});}).finally(function(){return setAppData({isLoading:false});});};useEffect(function(){localStorage.removeItem('userId');localStorage.removeItem('AuthToken');},[]);return/*#__PURE__*/_jsx(\"section\",{className:\"login__container container\",children:/*#__PURE__*/_jsxs(\"section\",{className:\"login__content\",children:[/*#__PURE__*/_jsx(Logo,{}),/*#__PURE__*/_jsx(\"h2\",{className:\"login__title\",children:\"Hello Again!\"}),/*#__PURE__*/_jsxs(\"section\",{className:\"login__register\",children:[/*#__PURE__*/_jsx(\"span\",{children:\"Not registered?\\xA0\"}),/*#__PURE__*/_jsx(Link,{className:\"login__register--link\",to:\"/register\",children:\"Register\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:onSubmit,className:\"login__form\",children:[/*#__PURE__*/_jsxs(\"section\",{className:\"login__inputs\",children:[/*#__PURE__*/_jsx(Input,{name:\"email\",placeholder:\"Enter login or email\",value:login,onChange:onLoginChange,errorMessage:loginError}),/*#__PURE__*/_jsx(Input,{name:\"password\",placeholder:\"Enter password\",value:password,onChange:onPasswordChange,errorMessage:passwordError})]}),/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsx(Button,{disabled:isLoading,children:\"Login\"})})]})]})});};export default Login;","map":{"version":3,"sources":["/Users/pc/KolomoyetsProjects/Study/project-zigzag/project-zigzag/client/src/views/login/index.tsx"],"names":["React","useEffect","useState","Link","useNavigate","AuthService","AppContext","Button","Input","Logo","SummaryContext","Login","login","setLogin","password","setPassword","loginError","setLoginError","passwordError","setPasswordError","useContext","isLoading","data","setAppData","setData","setSummaryData","navigate","onLoginChange","event","target","value","onPasswordChange","onSubmit","preventDefault","email","then","res","token","user","localStorage","setItem","_id","catch","err","console","log","response","message","isShow","isSuccess","title","subtitle","finally","removeItem"],"mappings":"6JAAA,MAAOA,CAAAA,KAAP,EAAwCC,SAAxC,CAAmDC,QAAnD,KAAwE,OAAxE,CACA,OAASC,IAAT,CAAeC,WAAf,KAAkC,kBAAlC,CAEA,MAAOC,CAAAA,WAAP,KAAwB,yBAAxB,CAEA,MAAOC,CAAAA,UAAP,KAAuB,yBAAvB,CAEA,MAAOC,CAAAA,MAAP,KAAmB,yBAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,wBAAlB,CAEA,MAAOC,CAAAA,IAAP,KAAiB,uBAAjB,CAEA,MAAO,cAAP,CACA,MAAOC,CAAAA,cAAP,KAA2B,6BAA3B,C,wFAEA,GAAMC,CAAAA,KAAU,CAAG,QAAbA,CAAAA,KAAa,EAAM,CACvB,cAA0BT,QAAQ,CAAC,EAAD,CAAlC,wCAAOU,KAAP,eAAcC,QAAd,eACA,eAAgCX,QAAQ,CAAC,EAAD,CAAxC,yCAAOY,QAAP,eAAiBC,WAAjB,eAEA,eAAoCb,QAAQ,CAAC,EAAD,CAA5C,yCAAOc,UAAP,eAAmBC,aAAnB,eACA,eAA0Cf,QAAQ,CAAC,EAAD,CAAlD,yCAAOgB,aAAP,eAAsBC,gBAAtB,eAEA,0BAAqDb,UAAU,CAACc,UAAX,EAArD,CAAgBC,SAAhB,uBAAQC,IAAR,CAAgBD,SAAhB,CAAsCE,UAAtC,uBAA6BC,OAA7B,CACA,0BAAoCd,cAAc,CAACU,UAAf,EAApC,CAAiBK,cAAjB,uBAAQD,OAAR,CAEA,GAAME,CAAAA,QAAQ,CAAGtB,WAAW,EAA5B,CAEA,GAAMuB,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,KAAD,CAA0C,CAC9Df,QAAQ,CAACe,KAAK,CAACC,MAAN,CAAaC,KAAd,CAAR,CACAb,aAAa,CAAC,EAAD,CAAb,CACD,CAHD,CAIA,GAAMc,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,CAACH,KAAD,CAA0C,CACjEb,WAAW,CAACa,KAAK,CAACC,MAAN,CAAaC,KAAd,CAAX,CACAX,gBAAgB,CAAC,EAAD,CAAhB,CACD,CAHD,CAKA,GAAMa,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACJ,KAAD,CAAsB,CACrC,GAAIA,KAAJ,CAAWA,KAAK,CAACK,cAAN,GAEX,GAAI,CAACrB,KAAL,CAAY,MAAOK,CAAAA,aAAa,CAAC,yBAAD,CAApB,CACZ,GAAI,CAACH,QAAL,CAAe,MAAOK,CAAAA,gBAAgB,CAAC,gBAAD,CAAvB,CAEfI,UAAU,CAAC,CAAEF,SAAS,CAAE,IAAb,CAAD,CAAV,CAEAhB,WAAW,CAACO,KAAZ,CAAkB,CAChBsB,KAAK,CAAEtB,KADS,CAEhBE,QAAQ,CAAEA,QAFM,CAAlB,EAICqB,IAJD,CAIM,SAAAC,GAAG,CAAI,CACX,cAAwBA,GAAG,CAACd,IAA5B,CAAQe,KAAR,WAAQA,KAAR,CAAeC,IAAf,WAAeA,IAAf,CAEAf,UAAU,CAAC,CAAEe,IAAI,CAAJA,IAAF,CAAQD,KAAK,CAALA,KAAR,CAAD,CAAV,CAEAE,YAAY,CAACC,OAAb,CAAqB,QAArB,CAA+BF,IAAI,CAACG,GAApC,EACAF,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAkCH,KAAlC,EACD,CAXD,EAYCF,IAZD,CAYM,iBAAMT,CAAAA,QAAQ,CAAC,OAAD,CAAd,EAZN,EAaCgB,KAbD,CAaO,SAAAC,GAAG,CAAI,CACZC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,QAAJ,CAAaC,OAAzB,EAEAhC,WAAW,CAAC,EAAD,CAAX,CACAF,QAAQ,CAAC,EAAD,CAAR,CAEAY,cAAc,CAAC,CACbuB,MAAM,CAAE,IADK,CAEbC,SAAS,CAAE,KAFE,CAGbC,KAAK,CAAE,uBAHM,CAIbC,QAAQ,CAAER,GAAG,CAACG,QAAJ,CAAaxB,IAAb,CAAkByB,OAJf,CAAD,CAAd,CAMD,CAzBD,EA0BCK,OA1BD,CA0BS,iBAAM7B,CAAAA,UAAU,CAAC,CAAEF,SAAS,CAAE,KAAb,CAAD,CAAhB,EA1BT,EA2BD,CAnCD,CAqCApB,SAAS,CAAC,UAAM,CACdsC,YAAY,CAACc,UAAb,CAAwB,QAAxB,EACAd,YAAY,CAACc,UAAb,CAAwB,WAAxB,EACD,CAHQ,CAGN,EAHM,CAAT,CAKA,mBACE,gBAAS,SAAS,CAAC,4BAAnB,uBACE,iBAAS,SAAS,CAAC,gBAAnB,wBACE,KAAC,IAAD,IADF,cAGE,WAAI,SAAS,CAAC,cAAd,0BAHF,cAKE,iBAAS,SAAS,CAAC,iBAAnB,wBACE,6CADF,cAEE,KAAC,IAAD,EAAM,SAAS,CAAC,uBAAhB,CAAwC,EAAE,CAAC,WAA3C,sBAFF,GALF,cAUE,cAAM,QAAQ,CAAErB,QAAhB,CAA0B,SAAS,CAAC,aAApC,wBACE,iBAAS,SAAS,CAAC,eAAnB,wBACE,KAAC,KAAD,EACE,IAAI,CAAC,OADP,CAEE,WAAW,CAAC,sBAFd,CAGE,KAAK,CAAEpB,KAHT,CAIE,QAAQ,CAAEe,aAJZ,CAKE,YAAY,CAAEX,UALhB,EADF,cAQE,KAAC,KAAD,EACE,IAAI,CAAC,UADP,CAEE,WAAW,CAAC,gBAFd,CAGE,KAAK,CAAEF,QAHT,CAIE,QAAQ,CAAEiB,gBAJZ,CAKE,YAAY,CAAEb,aALhB,EARF,GADF,cAkBE,sCACE,KAAC,MAAD,EAAQ,QAAQ,CAAEG,SAAlB,mBADF,EAlBF,GAVF,GADF,EADF,CAyCD,CAxGD,CA0GA,cAAeV,CAAAA,KAAf","sourcesContent":["import React, { ChangeEvent, FormEvent, useEffect, useState, VFC } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\n\nimport AuthService from '../../api/services/auth';\n\nimport AppContext from '../../store/context/app';\n\nimport Button from '../../components/button';\nimport Input from '../../components/input';\n\nimport Logo from '../../components/logo';\n\nimport './login.scss';\nimport SummaryContext from '../../store/context/summary';\n\nconst Login: VFC = () => {\n  const [login, setLogin] = useState('');\n  const [password, setPassword] = useState('');\n\n  const [loginError, setLoginError] = useState('');\n  const [passwordError, setPasswordError] = useState('');\n\n  const { data: { isLoading }, setData: setAppData } = AppContext.useContext();\n  const { setData: setSummaryData } = SummaryContext.useContext();\n\n  const navigate = useNavigate();\n\n  const onLoginChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setLogin(event.target.value);\n    setLoginError('');\n  }\n  const onPasswordChange = (event: ChangeEvent<HTMLInputElement>) => {\n    setPassword(event.target.value);\n    setPasswordError('');\n  }\n\n  const onSubmit = (event: FormEvent) => {\n    if (event) event.preventDefault();\n\n    if (!login) return setLoginError('Enter email or nickname');\n    if (!password) return setPasswordError('Enter password');\n\n    setAppData({ isLoading: true });\n\n    AuthService.login({\n      email: login,\n      password: password\n    })\n    .then(res => {\n      const { token, user } = res.data;\n\n      setAppData({ user, token });\n\n      localStorage.setItem('userId', user._id!);\n      localStorage.setItem('AuthToken', token);\n    })\n    .then(() => navigate('/main'))\n    .catch(err => {\n      console.log(err.response.message);\n\n      setPassword('');\n      setLogin('');\n\n      setSummaryData({\n        isShow: true,\n        isSuccess: false,\n        title: \"Something went wrong!\",\n        subtitle: err.response.data.message\n      });\n    })\n    .finally(() => setAppData({ isLoading: false }));\n  }\n\n  useEffect(() => {\n    localStorage.removeItem('userId');\n    localStorage.removeItem('AuthToken');\n  }, []);\n\n  return (\n    <section className=\"login__container container\">\n      <section className=\"login__content\">\n        <Logo />\n\n        <h2 className='login__title'>Hello Again!</h2>\n\n        <section className='login__register'>\n          <span>Not registered?&nbsp;</span>\n          <Link className='login__register--link' to='/register'>Register</Link>\n        </section>\n\n        <form onSubmit={onSubmit} className='login__form'>\n          <section className='login__inputs'>\n            <Input\n              name='email'\n              placeholder='Enter login or email'\n              value={login}\n              onChange={onLoginChange}\n              errorMessage={loginError}\n            />\n            <Input\n              name='password'\n              placeholder='Enter password'\n              value={password}\n              onChange={onPasswordChange}\n              errorMessage={passwordError}\n            />\n          </section>\n\n          <section>\n            <Button disabled={isLoading}>\n              Login\n            </Button>\n          </section>\n\n        </form>\n\n      </section>\n    </section>\n  )\n};\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}